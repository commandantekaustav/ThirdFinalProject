
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Final Documentation}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    Data Analysis and Morphological Classification of Galaxies from SDSS

    \subsection{Abstract:}\label{abstract}

According to Hubble Sequence, galaxies are divided into four
morphological groups: spiral, barred spiral, elliptical, and irregular.

For the study of cosmos- Ground-based telescopes aren't appropriate,
because the Earth's atmosphere absorbs a lot of the infrared and
ultraviolet light that passes through it. A space telescope or space
observatory is an instrument located in outer space to observe distant
planets, galaxies and other astronomical objects. Space telescopes avoid
many of the problems such as light pollution and distortion of
electromagnetic radiation (scintillation); ultraviolet frequencies,
X-rays and gamma rays are blocked by the Earth's atmosphere, so they can
only be observed from space.

The main object of this project is to: create a huge dataset and then
classify it.- to determine which all are stars, planets or galaxies.

Then, we'll go further. we will try to classify each galaxy according to
their types/shapes/morphologies and see the distributions

    \subsubsection{MOTIVATION:}\label{motivation}

Chandra is one of the Great Observatories in India, along with the
Hubble Space Telescope in NASA, Compton Gamma Ray Observatory
(1991--2000), and the Spitzer Space Telescope. The telescope is named
after the Nobel Prize-winning Indian-American astrophysicist
Subrahmanyan Chandrasekhar.

When I came to know about this, it gave me food for my imagination about
outer galaxies.

Space telescopes tend to avoid real life problems, as - Light pollution,
Scinrillation (Distortion of electro-magnetic radiation) etc. Moreover -
Ultra violent frequencies, X-Rays and gamma rays are blocked by the
Earth's atmosphere, so they can only be observed from space.

Being a huge Christopher Nolan fan (obviously am talking about the
sci-fi's) my object to develop this project is to: Create a huge dataset
and then classify it, to determine which all are stars or planets or
galaxies.

    \subsection{ Introduction:}\label{introduction}

Astronomy dates back as far as the ancient Indians, the Egyptians, the
Mayans, the Inkas and the Mesopotemians. Astronomy was used as a means
of keeping track of time and predicting future events which was achieved
through a combination of religion, astrology and the meticulous study of
the positions and motions of various celestial bodies. It is generally
believed that priests were the first professional astronomers, the
pioneers of the field. The real renaissance of astronomy began in the
1500s when Nicholaus Copernicus, a Polish university-trained Catholic
priest, mathematician and astronomer, proposed a heliocentric model of
our Universe in which the Sun, rather than the Earth, is in the center
of the Solar System. Figure in the left graphically illustrates this
model. Just before he died in 1543, he published a book entitled De
revolutionibus orbium coelestium (On the Revolutions of the Celestial
Spheres) which became one of the most important contributions towards
the scientific revolution.

\subsubsection{Terminologies:}\label{terminologies}

Galaxy: A galaxy is defined as a populous system of stars, dust, dark
matter and gases that are all bound together by gravity. There are
numerous sizes that a galaxy can possess in terms of the number of stars
that live within it, ranging anywhere from 10 million to 10 trillion
stars. There are two common general shapes that a galaxy can take,
either spiral or elliptical. Many variations within each also exist as
well as less-common shapes such as toothpicks or rings. Messier 64 (M64)
- A spiral galaxy, the result of a collision between two galaxies. Due
to the spectacular dark band of dust surrounding the galaxy's bright
nuclues, its been nicknamed by some as the Evil Eye galaxy (credit:
hubblesite.org). Star: A star, our Sun being a perfect example, is
essentially a sphere of immensely hot gas, mainly that of hydrogen,
partly helium and with minute traces of other various gases. Within its
core, an incredible amount of energy is generated through the process of
fusion in which smaller atoms smash together at great speeds to form
larger atoms. Likewise with galaxies, astronomers also have a process
for classifying stars. They are grouped into spectral types. By
spectral, we refer to the temperature and brightness of the surfaces of
the stars. Quasar: a massive and extremely remote celestial object,
emitting exceptionally large amounts of energy, and typically having a
starlike image in a telescope. It has been suggested that quasars
contain massive black holes and may represent a stage in the evolution
of some galaxies.(Above figure contains some of the clearest light views
of quasar taken till date.) (credit: nasa.gov) Morphology: Galaxy
morphology is a visual grouping system used by astronomers for galaxy
classification. Almost a hundred years have now passed since it was
first discovered that galaxies were independent systems subjected to
morphology and mergers. The most famous system for morphological
classification, known as the Hubble Tuning Fork System, was proposed by
American astronomer Edwin Powell Hubble in the year 1936. In 1936, when
Hubble released his book Realm of the Nebulae, that research in the area
became abundant and the study of galaxy morphology became a well
established sub-field of optical astronomy. Since then, there have been
numerous studies and proposed revisions to the Fork Sequence that have
been published. Hubble is generally regarded, in the field, as one of
the most important observational cosmologists of the 20th century who
played an important role in the establishment of the field of
extragalactic astronomy. Redshift: A shift toward longer wavelengths of
the spectral lines emitted by a celestial object that is caused by the
object moving away from the earth. It is used by astronomers to compare
the distances among two faraway celestial objects.

    \subsection{Objectives:}\label{objectives}

The datasets, which will be used in this project are not balanced. SDSS
left almost 70\% of it's entries unclassified. On the other hand most of
the galaxies in the GalaxyZoo project are labelled as Uncertain. This is
because GalaxyZoo uses human classifiers and in many cases the
volunteers do not agree on a single conclusion. A 80\% voting threshold
is used to determine the morphology of each galaxy. Although such a high
threshold is desirable, the outcome has significantly increased
uncertainty instead of helping astronomers and cosmologists in their
quest to unfold the facts about our universe. Combined datasets contain
some probabilistic scores of each morphological classes according to
each entry. This scores will help a lot in our research work. Main aim
of this project is to perform an intelligent data analysis technique to
resolve this uncertainities. Three datasets with 1000,10000 and 100000
are used here for performance comparision purposes.

    \subsection{Requirement Analysis and
Specification:}\label{requirement-analysis-and-specification}

\subsubsection{Data Excavation Sites:}\label{data-excavation-sites}

Datasets used this project are mined from the following servers;

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  GalaxyZoo1:

  Galaxy Zoo is a crowdsourced astronomy project which invites people to
  assist in the morphological classification of large numbers of
  galaxies. It is an example of citizen science as it enlists the help
  of members of the public to help in scientific research.There have
  been 15 versions as of July 2017, many of which are outlined in this
  article. Galaxy Zoo is part of the Zooniverse, a group of citizen
  science projects. An outcome of the project is to better determine the
  different aspects of objects and to separate them into
  classifications.

  A subscript from their official page says the following:
\end{enumerate}

\begin{quote}
"\emph{Galaxy Zoo is a scientific project that has invited members of
the public to help classify a million galaxies. Those involved are
directly contributing to scientific research, while getting an
opportunity to view the beautiful and varied galaxies that inhabit our
universe.Why do we need people to do this, rather than just using a
computer? The simple answer is that the human brain is much better at
recognising patterns than a computer. Galaxies are complicated objects
that vary in appearance enormously, and yet in some ways they can be
very similar. We could write a computer program to classify these
galaxies, and many researchers have, but so far none have really done a
good enough job. We have not been able to make computers `see past' the
complexity, to reliably identify the similarities that appear obvious to
our eyes and brain. For now, and probably for some time yet, people do
the best job of classifying galaxies.}" \textgreater{}

"\emph{Getting all these galaxy classifications is just the first stage
of our project. What we really want to do is some science, to try and
understand what kind of galaxies there are, how they formed, and the
processes that have changed them into the systems we see today. The
journey from raw classifications to accepted scientific results is often
long and arduous. In this blog we aim to explain the steps involved, and
the scientific ideas we are working on.}"
\end{quote}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  GalaxyZoo2: The original Galaxy Zoo consisted of a data set made up of
  â‰ˆ900,000 galaxies imaged by the Sloan Digital Sky Survey. With so many
  galaxies, it had been assumed that it would take years for visitors to
  the site to work through them all, but within 24 hours of launch, the
  website was receiving almost 70,000 classifications an hour. In the
  end, more than 50 million classifications were received by the project
  during its first year, contributed by more than 150,000 people. This
  was started in July 2007 and retired in 2009. \textbf{GalaxyZoo2}
  consisted of some 250,000 of the brightest galaxies from the Sloan
  Digital Sky Survey. Galaxy Zoo 2 allowed for a much more detailed
  classification, by shape and by the intensity or dimness of the
  galactic core, and with a special section for oddities like mergers or
  ring galaxies. The sample also contained fewer optical oddities. The
  project closed with some 60 million classifications
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Sloan Digital SkyServer(\emph{10th,12th and 14th release})\textbf{:}
  The Sloan Digital Sky Survey or SDSS is a major multi-spectral imaging
  and spectroscopic redshift survey using a dedicated 2.5-m wide-angle
  optical telescope at Apache Point Observatory in New Mexico, United
  States. The project was named after the Alfred P. Sloan Foundation,
  which contributed significant funding. Data collection began in 2000;
  the final imaging data release (DR9) covers over 35\% of the sky, with
  photometric observations of around nearly 1 billion objects, while the
  survey continues to acquire spectra, having so far taken spectra of
  over 4 million objects. The main galaxy sample has a median redshift
  of z = 0.1; there are redshifts for luminous red galaxies as far as z
  = 0.7, and for quasars as far as z = 5; and the imaging survey has
  been involved in the detection of quasars beyond a redshift z = 6.
  Data release 8 (DR8), released in January 2011, includes all
  photometric observations taken with the SDSS imaging camera, covering
  14,555 square degrees on the sky (just over 35\% of the full sky).
  Data release 9 (DR9), released to the public on 31 July 2012, includes
  the first results from the Baryon Oscillation Spectroscopic Survey
  (BOSS) spectrograph, including over 800,000 new spectra. Over 500,000
  of the new spectra are of objects in the Universe 7 billion years ago
  (roughly half the age of the universe). Data release 10 (DR10),
  released to the public on 31 July 2013, includes all data from
  previous releases, plus the first results from the APO Galactic
  Evolution Experiment (APOGEE) spectrograph, including over 57,000
  high-resolution infrared spectra of stars in the Milky Way. DR10 also
  includes over 670,000 new BOSS spectra of galaxies and quasars in the
  distant universe. The publicly available images from the survey were
  made between 1998 and 2009. 
\end{enumerate}

    \textbf{Query used for mining the Data}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{getData }\KeywordTok{function}\NormalTok{(n)}\OperatorTok{\{}
\NormalTok{    select top n}
    \VariableTok{p}\NormalTok{.}\AttributeTok{objid}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{ra}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{dec}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{u}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{g}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{r}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{i}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{z}\OperatorTok{,}
    \VariableTok{p}\NormalTok{.}\AttributeTok{run}\OperatorTok{,} \VariableTok{p}\NormalTok{.}\AttributeTok{rerun}\OperatorTok{,} \VariableTok{p}\NormalTok{.}\AttributeTok{camcol}\OperatorTok{,} \VariableTok{p}\NormalTok{.}\AttributeTok{field}\OperatorTok{,}
     \VariableTok{p}\NormalTok{.}\AttributeTok{mCr4_u}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{mCr4_g}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{mCr4_r}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{mCr4_i}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{mCr4_z}\OperatorTok{,}
     \VariableTok{p}\NormalTok{.}\AttributeTok{mCr4PSF_u}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{mCr4PSF_g}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{mCr4PSF_r}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{mCr4PSF_i}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{mCr4PSF_z}\OperatorTok{,}
     \VariableTok{p}\NormalTok{.}\AttributeTok{petroR50_u}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{petroR50_g}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{petroR50_r}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{petroR50_i}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{petroR50_z}\OperatorTok{,}
     \VariableTok{p}\NormalTok{.}\AttributeTok{petroR90_u}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{petroR90_g}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{petroR90_r}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{petroR90_i}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{petroR90_z}\OperatorTok{,}\VariableTok{p}\NormalTok{.}\AttributeTok{type}\OperatorTok{,}
     \VariableTok{s}\NormalTok{.}\AttributeTok{specobjid}\OperatorTok{,} \VariableTok{s}\NormalTok{.}\AttributeTok{class}\OperatorTok{,}\VariableTok{s}\NormalTok{.}\AttributeTok{subClass}\OperatorTok{,} \VariableTok{s}\NormalTok{.}\AttributeTok{z} \AttributeTok{as} \AttributeTok{redshift}\OperatorTok{,}
     \VariableTok{s}\NormalTok{.}\AttributeTok{plate}\OperatorTok{,} \VariableTok{s}\NormalTok{.}\AttributeTok{mjd}\OperatorTok{,} \VariableTok{s}\NormalTok{.}\AttributeTok{fiberid}\OperatorTok{,}\VariableTok{s}\NormalTok{.}\AttributeTok{sourceType}\OperatorTok{,}
     \VariableTok{z}\NormalTok{.}\AttributeTok{nvote}\OperatorTok{,}\VariableTok{z}\NormalTok{.}\AttributeTok{p_el}\OperatorTok{,}\VariableTok{z}\NormalTok{.}\AttributeTok{p_cw}\OperatorTok{,}\VariableTok{z}\NormalTok{.}\AttributeTok{p_acw}\OperatorTok{,}\VariableTok{z}\NormalTok{.}\AttributeTok{p_edge}\OperatorTok{,}\VariableTok{z}\NormalTok{.}\AttributeTok{p_dk}\OperatorTok{,}\VariableTok{z}\NormalTok{.}\AttributeTok{p_mg}
\NormalTok{     FROM PhotoObjAll AS p}
\NormalTok{     JOIN SpecObjAll AS s ON }\VariableTok{s}\NormalTok{.}\AttributeTok{bestObjID} \OperatorTok{=} \VariableTok{p}\NormalTok{.}\AttributeTok{objID} \AttributeTok{JOIN} \AttributeTok{zooNoSpec} \AttributeTok{as} \AttributeTok{z} \AttributeTok{on} \VariableTok{p}\NormalTok{.}\AttributeTok{objID} \OperatorTok{=} \VariableTok{z}\NormalTok{.}\AttributeTok{objID}
\OperatorTok{\}}
\end{Highlighting}
\end{Shaded}

\textbf{\emph{Data Description}}: First Dataset contains 1000 entries
from GalaxyZoo Second and Third Dataset contains 10000 and 100000
combined entries respectively from all the servers and multiple
relations.

    \subsubsection{Tools and Languages
used:}\label{tools-and-languages-used}

Languages Used: 1. Python:

Python is an interpreted, high-level, general-purpose programming
language. Created by Guido van Rossum and first released in 1991,
Python's design philosophy emphasizes code readability with its notable
use of significant whitespace.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  SQL:

  SQL is a domain-specific language used in programming and designed for
  managing data held in a relational database management system, or for
  stream processing in a relational data stream management system.
\item
  Markdown:

  Markdown is a lightweight markup language with plain text formatting
  syntax. Its design allows it to be converted to many output formats,
  but the original tool by the same name only supports HTML.
\end{enumerate}

Tools Used: : 1. Spyder3 IDE:

Spyder is a powerful scientific environment written in Python, for
Python, and designed by and for scientists, engineers and data analysts.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Space Engine:

  SpaceEngine is a proprietary 3D astronomy program and game engine
  developed by Russian astronomer and programmer Vladimir Romanyuk. It
  creates a three-dimensional planetarium representing the entire
  universe from a combination of real astronomical data and
  scientifically-accurate procedural generation algorithms.
\item
  Stellarium:

  Stellarium is an open-source free-software planetarium, licensed under
  the terms of the GNU General Public License version 2, available for
  Linux, Windows, and macOS. A port Stellarium called Stellarium Mobile
  is available for Android, iOS, and Symbian as a paid version, being
  developed by Noctua Software.
\item
  SDSS SkyServer SQL Search Tool:

  Search tool for the public database of SDSS.
\item
  Hubble Voyage:

  Exploration tools especially made for students, educators and
  hobbyists. Used for checking observations manually.
\item
  Astrometry: Exploration tool for constellations.
\end{enumerate}

Data can be easily mined from the skyserver by using their own sql based
search tool which is available at
\emph{https://skyserver.sdss.org/dr12/en/tools/search/sql.aspx }.
Observations can be checked manually using another tool from the
skyserver popularly known as the \textbf{voyage:}
\emph{http://cas.sdss.org/dr15/en/tools/chart/navi.aspx} and is widely
used by the educators and students from all over the world! or
;\textbf{astrometry:} \emph{http://nova.astrometry.net/user\_images}

    \subsubsection{Algorithms Used:}\label{algorithms-used}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Decision Tree Algorithm:

  DescriptionIn computer science, Decision tree learning uses a decision
  tree to go from observations about an item to conclusions about the
  item's target value. It is one of the predictive modeling approaches
  used in statistics, data mining and machine learning.
\item
  Random Forest Algorithm:

  Random forests or random decision forests are an ensemble learning
  method for classification, regression and other tasks that operates by
  constructing a multitude of decision trees at training time and
  outputting the class that is the mode of the classes or mean
  prediction of the individual trees.
\end{enumerate}

    \subsubsection{Importing Libraries:}\label{importing-libraries}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}210}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np} 
          \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd} 
          \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
          
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{cross\PYZus{}val\PYZus{}predict}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k}{import} \PY{n}{DecisionTreeClassifier}
          \PY{k+kn}{import} \PY{n+nn}{itertools}  
          
          \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
          \PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{offline} \PY{k}{as} \PY{n+nn}{py}
          \PY{n}{color} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{color\PYZus{}palette}\PY{p}{(}\PY{p}{)}
          \PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{graph\PYZus{}objs} \PY{k}{as} \PY{n+nn}{go}
          \PY{n}{py}\PY{o}{.}\PY{n}{init\PYZus{}notebook\PYZus{}mode}\PY{p}{(}\PY{n}{connected}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{tools} \PY{k}{as} \PY{n+nn}{tls}
          
          \PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k}{import} \PY{n}{Math}
          
          \PY{k+kn}{import} \PY{n+nn}{warnings}
          \PY{n}{warnings}\PY{o}{.}\PY{n}{filterwarnings}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{SMALL\PYZus{}SIZE} \PY{o}{=} \PY{l+m+mi}{10}
          \PY{n}{MEDIUM\PYZus{}SIZE} \PY{o}{=} \PY{l+m+mi}{12}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{rc}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{n}{SMALL\PYZus{}SIZE}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{rc}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{axes}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{titlesize}\PY{o}{=}\PY{n}{MEDIUM\PYZus{}SIZE}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{rc}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{axes}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelsize}\PY{o}{=}\PY{n}{MEDIUM\PYZus{}SIZE}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure.dpi}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{150}
\end{Verbatim}


    
    
    \subsection{Dataset 1:}\label{dataset-1}

This dataset is limited to only three types of galaxy: spirals,
ellipticals and mergers. It is a sample of galaxies where at least 20
human classifiers agreed to the same galaxy type. Examples of spiral and
elliptical galaxies were selected where there was a unanimous
classification. Due to low sample numbers, merger examples ar included
which holds an 80\% threshold, so that the classifier can be trained in
a better way.

Features used in these datasets are derived from fitting images
according to known galaxy profiles and are mostly based on flux
magnitudes.(SDSS used 'u','g','r','i','z' photometric system).

Feature Description:

Color Index: Spectroscopic wavebands (u,g,r,i,z for this project).

Adaptive moments: Adaptive moments are the second moments of the object
intensity, measured using a particular scheme designed to have
near-optimal signal-to-noise ratio. Moments are measured using a radial
weight function interactively adapted to the shape (ellipticity) and
size of the object. This elliptical weight function has a
signal-to-noise advantage over axially symmetric weight functions. In
principle there is an optimal (in terms of signal-to-noise) radial shape
for the weight function, which is related to the light profile of the
object itself. Adaptive moments also describe the shape of a galaxy.
They are used in image analysis to detect similar objects at different
sizes and orientations. We use the fourth moment here for each band.

Concentration: Concentration is similar to the luminosity profile of the
galaxy, which measures what proportion of a galaxy's total light is
emitted within what radius. A simplified way to represent this is to
take the ratio of the radii containing 50\% and 90\% of the Petrosian
flux.

The Petrosian method allows us to compare the radial profiles of
galaxies at different distances. If you are interested, you can read
more here on the need for Petrosian approach.

For these experiments, we will define concentration as:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{mbox}\PY{l+s+si}{\PYZob{}conc\PYZcb{}}\PY{l+s+s1}{ = }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{frac}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{mbox}\PY{l+s+si}{\PYZob{}petro\PYZcb{}}\PY{l+s+s1}{\PYZus{}}\PY{l+s+si}{\PYZob{}R50\PYZcb{}}\PY{l+s+s1}{\PYZcb{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{mbox}\PY{l+s+si}{\PYZob{}petro\PYZcb{}}\PY{l+s+s1}{\PYZus{}}\PY{l+s+si}{\PYZob{}R90\PYZcb{}}\PY{l+s+s1}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

\texttt{\color{outcolor}Out[{\color{outcolor}2}]:}
    
    $$\mbox{conc} = \frac{\mbox{petro}_{R50}}{\mbox{petro}_{R90}}$$

    

    We will use the concentration from the u, r and z bands.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{data1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D:}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{ThirdFinalProject}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Data\PYZus{}Mining}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{GalaxyMorphologicalExcavation.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
        \PY{n}{fraction\PYZus{}training} \PY{o}{=} \PY{l+m+mf}{0.7}
        \PY{n}{msk} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{rand}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{data1}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{n}{fraction\PYZus{}training}
        \PY{n}{data1\PYZus{}train} \PY{o}{=} \PY{n}{data1}\PY{p}{[}\PY{n}{msk}\PY{p}{]}
        \PY{n}{data1\PYZus{}test} \PY{o}{=} \PY{n}{data1}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{msk}\PY{p}{]}
        
        
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number data galaxies:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data1}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train fraction:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fraction\PYZus{}training}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of galaxies in training set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data1\PYZus{}train}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of galaxies in testing set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data1\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Number data galaxies: 780
Train fraction: 0.7
Number of galaxies in training set: 513
Number of galaxies in testing set: 267

    \end{Verbatim}

    \paragraph{Data Correlation:}\label{data-correlation}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{fig} \PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
        \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{data1}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{Data Distribution with repect to
Redshift:}\label{data-distribution-with-repect-to-redshift}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{data1}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_18_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Feature Selection}\label{feature-selection}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{k}{def} \PY{n+nf}{generate\PYZus{}features\PYZus{}targets}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
        
          \PY{n}{targets} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
          \PY{n}{features} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{n}{shape}\PY{o}{=}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{13}\PY{p}{)}\PY{p}{)}
          \PY{n}{features}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{u\PYZhy{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{features}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g\PYZhy{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{features}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}i}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{features}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{i\PYZhy{}z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{features}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ecc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{features}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m4\PYZus{}u}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{features}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m4\PYZus{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{features}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m4\PYZus{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{features}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m4\PYZus{}i}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{features}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m4\PYZus{}z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
          
          \PY{c+c1}{\PYZsh{} concentration in u filter}
          \PY{n}{features}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR50\PYZus{}u}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR90\PYZus{}u}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
          \PY{c+c1}{\PYZsh{} concentration in r filter}
          \PY{n}{features}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{11}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR50\PYZus{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR90\PYZus{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
          \PY{c+c1}{\PYZsh{} concentration in z filter}
          \PY{n}{features}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR50\PYZus{}z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR90\PYZus{}z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
        
          \PY{k}{return} \PY{n}{features}\PY{p}{,} \PY{n}{targets}
        
        
        \PY{c+c1}{\PYZsh{}  data = np.load(\PYZsq{}galaxy\PYZus{}catalogue.npy\PYZsq{})}
        
        \PY{n}{data1\PYZus{}features}\PY{p}{,} \PY{n}{data1\PYZus{}targets} \PY{o}{=} \PY{n}{generate\PYZus{}features\PYZus{}targets}\PY{p}{(}\PY{n}{data1}\PY{p}{)}
        
          \PY{c+c1}{\PYZsh{} Print the shape of each array to check the arrays are the correct dimensions. }
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Features shape:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data1\PYZus{}features}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Targets shape:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data1\PYZus{}targets}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Features shape: (780, 13)
Targets shape: (780,)

    \end{Verbatim}

    \subsubsection{Morphological Classification of Galaxies using Decision
Tree}\label{morphological-classification-of-galaxies-using-decision-tree}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k}{import} \PY{n}{DecisionTreeClassifier}
        \PY{n}{dtc} \PY{o}{=} \PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{p}{)}
        \PY{n}{data1\PYZus{}train\PYZus{}features}\PY{p}{,} \PY{n}{data1\PYZus{}train\PYZus{}targets} \PY{o}{=} \PY{n}{generate\PYZus{}features\PYZus{}targets}\PY{p}{(}\PY{n}{data1\PYZus{}train}\PY{p}{)}
        \PY{n}{data1\PYZus{}test\PYZus{}features}\PY{p}{,} \PY{n}{data1\PYZus{}test\PYZus{}targets} \PY{o}{=} \PY{n}{generate\PYZus{}features\PYZus{}targets}\PY{p}{(}\PY{n}{data1\PYZus{}test}\PY{p}{)}
        \PY{n}{dtc}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{data1\PYZus{}train\PYZus{}features}\PY{p}{,} \PY{n}{data1\PYZus{}train\PYZus{}targets}\PY{p}{)}
        \PY{n}{data1\PYZus{}predictions} \PY{o}{=} \PY{n}{dtc}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{data1\PYZus{}test\PYZus{}features}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{k}{def} \PY{n+nf}{plot\PYZus{}confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{cm}\PY{p}{,} \PY{n}{classes}\PY{p}{,}
                                  \PY{n}{normalize}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                  \PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Confusion matrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                  \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{Blues}\PY{p}{)}\PY{p}{:}
            \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+sd}{    This function prints and plots the confusion matrix.}
        \PY{l+s+sd}{    Normalization can be applied by setting `normalize=True`.}
        \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
            \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{cm}\PY{p}{,} \PY{n}{interpolation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{nearest}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{cmap}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{title}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
            \PY{n}{tick\PYZus{}marks} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{classes}\PY{p}{)}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n}{tick\PYZus{}marks}\PY{p}{,} \PY{n}{classes}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{yticks}\PY{p}{(}\PY{n}{tick\PYZus{}marks}\PY{p}{,} \PY{n}{classes}\PY{p}{)}
        
            \PY{k}{if} \PY{n}{normalize}\PY{p}{:}
                \PY{n}{cm} \PY{o}{=} \PY{n}{cm}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o}{/} \PY{n}{cm}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{newaxis}\PY{p}{]}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Normalized confusion matrix}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            \PY{k}{else}\PY{p}{:}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Confusion matrix, without normalization}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{cm}\PY{p}{)}
        
            \PY{n}{thresh} \PY{o}{=} \PY{n}{cm}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{2.}
            \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{j} \PY{o+ow}{in} \PY{n}{itertools}\PY{o}{.}\PY{n}{product}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n}{cm}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{range}\PY{p}{(}\PY{n}{cm}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                \PY{n}{plt}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{n}{j}\PY{p}{,} \PY{n}{i}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{cm}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{n}{j}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                         \PY{n}{horizontalalignment}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{center}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                         \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{white}\PY{l+s+s2}{\PYZdq{}} \PY{k}{if} \PY{n}{cm}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{n}{j}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{n}{thresh} \PY{k}{else} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{black}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        
            \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted Class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            
        \PY{k}{def} \PY{n+nf}{calculate\PYZus{}accuracy}\PY{p}{(}\PY{n}{predicted\PYZus{}classes}\PY{p}{,} \PY{n}{actual\PYZus{}classes}\PY{p}{)}\PY{p}{:}
          \PY{k}{return} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{predicted\PYZus{}classes} \PY{o}{==} \PY{n}{actual\PYZus{}classes}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{actual\PYZus{}classes}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{data1\PYZus{}predicted} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}predict}\PY{p}{(}\PY{n}{dtc}\PY{p}{,} \PY{n}{data1\PYZus{}features}\PY{p}{,} \PY{n}{data1\PYZus{}targets}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} calculate the model score using your function}
        \PY{n}{data1\PYZus{}model\PYZus{}score} \PY{o}{=} \PY{n}{calculate\PYZus{}accuracy}\PY{p}{(}\PY{n}{data1\PYZus{}predicted}\PY{p}{,} \PY{n}{data1\PYZus{}targets}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Our accuracy score:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data1\PYZus{}model\PYZus{}score}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} calculate the models confusion matrix using sklearns confusion\PYZus{}matrix function}
        \PY{n}{data1\PYZus{}class\PYZus{}labels} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{data1\PYZus{}targets}\PY{p}{)}\PY{p}{)}
        \PY{n}{data1\PYZus{}model\PYZus{}cm\PYZus{}dtc} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}true}\PY{o}{=}\PY{n}{data1\PYZus{}targets}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{o}{=}\PY{n}{data1\PYZus{}predicted}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{data1\PYZus{}class\PYZus{}labels}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}classification report}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{classification\PYZus{}report}
        \PY{n}{class\PYZus{}names} \PY{o}{=} \PY{n}{data1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{classification report of Decision Tree Classifier:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{data1\PYZus{}targets}\PY{p}{,} \PY{n}{data1\PYZus{}predicted}\PY{p}{,}\PY{n}{target\PYZus{}names}\PY{o}{=}\PY{n}{class\PYZus{}names}\PY{p}{)}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Plot the confusion matrix using the provided functions.}
        \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
        \PY{n}{plot\PYZus{}confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{data1\PYZus{}model\PYZus{}cm\PYZus{}dtc}\PY{p}{,} \PY{n}{classes}\PY{o}{=}\PY{n}{data1\PYZus{}class\PYZus{}labels}\PY{p}{,} \PY{n}{normalize}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Our accuracy score: 0.7923076923076923
classification report of Decision Tree Classifier:

             precision    recall  f1-score   support

     merger       0.89      0.90      0.89       260
 elliptical       0.70      0.71      0.71       260
     spiral       0.78      0.77      0.78       260

avg / total       0.79      0.79      0.79       780

Confusion matrix, without normalization
[[185  23  52]
 [ 23 233   4]
 [ 55   5 200]]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_24_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Morphological Classification of Galaxies using Random
Forest}\label{morphological-classification-of-galaxies-using-random-forest}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}156}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{cross\PYZus{}val\PYZus{}predict}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}
          
          
          \PY{c+c1}{\PYZsh{} complete this function to get predictions from a random forest classifier}
          \PY{k}{def} \PY{n+nf}{rf\PYZus{}predict\PYZus{}actual}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{n\PYZus{}estimators}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} generate the features and targets}
            \PY{n}{features}\PY{p}{,} \PY{n}{targets} \PY{o}{=} \PY{n}{generate\PYZus{}features\PYZus{}targets}\PY{p}{(}\PY{n}{data}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} instantiate a random forest classifier}
            \PY{n}{rfc} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{n\PYZus{}estimators}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} get predictions using 10\PYZhy{}fold cross validation with cross\PYZus{}val\PYZus{}predict}
            \PY{n}{predicted} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}predict}\PY{p}{(}\PY{n}{rfc}\PY{p}{,} \PY{n}{features}\PY{p}{,} \PY{n}{targets}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} return the predictions and their actual classes}
            \PY{k}{return} \PY{n}{predicted}\PY{p}{,} \PY{n}{targets}
          
          
          \PY{c+c1}{\PYZsh{} get the predicted and actual classes}
          \PY{n}{data1\PYZus{}number\PYZus{}estimators} \PY{o}{=} \PY{l+m+mi}{50}              \PY{c+c1}{\PYZsh{} Number of trees}
          \PY{n}{data1\PYZus{}predicted}\PY{p}{,} \PY{n}{data1\PYZus{}actual} \PY{o}{=} \PY{n}{rf\PYZus{}predict\PYZus{}actual}\PY{p}{(}\PY{n}{data1}\PY{p}{,} \PY{n}{data1\PYZus{}number\PYZus{}estimators}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} calculate the model score using your function}
          \PY{n}{data1\PYZus{}accuracy} \PY{o}{=} \PY{n}{calculate\PYZus{}accuracy}\PY{p}{(}\PY{n}{data1\PYZus{}predicted}\PY{p}{,} \PY{n}{data1\PYZus{}actual}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy score:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data1\PYZus{}accuracy}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} calculate the models confusion matrix using sklearns confusion\PYZus{}matrix function}
          \PY{n}{data1\PYZus{}class\PYZus{}labels} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{data1\PYZus{}actual}\PY{p}{)}\PY{p}{)}
          \PY{n}{data1\PYZus{}model\PYZus{}cm\PYZus{}rfc} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}true}\PY{o}{=}\PY{n}{data1\PYZus{}actual}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{o}{=}\PY{n}{data1\PYZus{}predicted}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{data1\PYZus{}class\PYZus{}labels}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} classification report of Random Forest Classifier}
          \PY{n}{data1\PYZus{}class\PYZus{}names} \PY{o}{=} \PY{n}{data1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{classification report of Decision Tree Classifier:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{data1\PYZus{}targets}\PY{p}{,} \PY{n}{data1\PYZus{}predicted}\PY{p}{,}\PY{n}{target\PYZus{}names}\PY{o}{=}\PY{n}{data1\PYZus{}class\PYZus{}names}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} plot the confusion matrix using the provided functions.}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plot\PYZus{}confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{data1\PYZus{}model\PYZus{}cm\PYZus{}rfc}\PY{p}{,} \PY{n}{classes}\PY{o}{=}\PY{n}{data1\PYZus{}class\PYZus{}labels}\PY{p}{,} \PY{n}{normalize}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy score: 0.8666666666666667
classification report of Decision Tree Classifier:

             precision    recall  f1-score   support

     merger       0.92      0.95      0.94       260
 elliptical       0.80      0.81      0.81       260
     spiral       0.88      0.84      0.86       260

avg / total       0.87      0.87      0.87       780

Confusion matrix, without normalization
[[211  19  30]
 [ 12 247   1]
 [ 40   2 218]]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_26_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Dataset 2:}\label{dataset-2}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{n}{df}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D:}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{ThirdFinalProject}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Data\PYZus{}Mining}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{data.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Dataset 2 contains }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ entries and }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ features}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Dataset 2 contains 10000 entries and 48 features
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 10000 entries, 0 to 9999
Data columns (total 48 columns):
objid         10000 non-null float64
ra            10000 non-null float64
dec           10000 non-null float64
u             10000 non-null float64
g             10000 non-null float64
r             10000 non-null float64
i             10000 non-null float64
z             10000 non-null float64
run           10000 non-null int64
rerun         10000 non-null int64
camcol        10000 non-null int64
field         10000 non-null int64
mCr4\_u        10000 non-null float64
mCr4\_g        10000 non-null float64
mCr4\_r        10000 non-null float64
mCr4\_i        10000 non-null float64
mCr4\_z        10000 non-null float64
mCr4PSF\_u     10000 non-null float64
mCr4PSF\_g     10000 non-null float64
mCr4PSF\_r     10000 non-null float64
mCr4PSF\_i     10000 non-null float64
mCr4PSF\_z     10000 non-null float64
petroR50\_u    10000 non-null float64
petroR50\_g    10000 non-null float64
petroR50\_r    10000 non-null float64
petroR50\_i    10000 non-null float64
petroR50\_z    10000 non-null float64
petroR90\_u    10000 non-null float64
petroR90\_g    10000 non-null float64
petroR90\_r    10000 non-null float64
petroR90\_i    10000 non-null float64
petroR90\_z    10000 non-null float64
type          10000 non-null int64
specobjid     10000 non-null float64
class         10000 non-null object
subClass      2453 non-null object
redshift      10000 non-null float64
plate         10000 non-null int64
mjd           10000 non-null int64
fiberid       10000 non-null int64
sourceType    10000 non-null object
nvote         10000 non-null int64
p\_el          10000 non-null float64
p\_cw          10000 non-null float64
p\_acw         10000 non-null float64
p\_edge        10000 non-null float64
p\_dk          10000 non-null float64
p\_mg          10000 non-null float64
dtypes: float64(36), int64(9), object(3)
memory usage: 3.7+ MB
None

    \end{Verbatim}

    \subsubsection{Feature Description:}\label{feature-description}

Objid, Specobjid and Fibreid: Primary ID for all SDSS objects and Unique
ID for SPECOBJ table and SpecObjAll table respectively.

RA, Dec: Right Ascension and Declination.

u,g,r,i,z: SDSS color spectums or Filters.

Run: Imaging run.

Rerun: Rerun number.

Camcol: Camera column.

Field: Field number.

mcr4: Adaptive fourth moment of object.

mcr4PSF: Adaptive fourth moment of object for Petrusian Flux.

PetroR50: Radius containing 50\% of Petrosian flux

PetroR90: Radius containing 90\% of Petrosian flux

Type: Morphological type classification of the object.

Class: Spectroscopic classification of the object.

Subclass: Spectroscopic subclass of the object.

Redshift: Redshift of the object In physics, redshift happens when light
or other electromagnetic radiation from an object is increased in
wavelength, or shifted to the red end of the spectrum.

Each spectroscopic exposure employs a large, thin, circular metal plate
that positions optical fibers via holes drilled at the locations of the
images in the telescope focal plane. These fibers then feed into the
spectrographs. Each plate has a unique serial number, which is called
plate in views such as SpecObj in the CAS.

Plate: Plate number.

mjd: Modified Julian Date, used to indicate the date that a given piece
of SDSS data (image or spectrum) was taken.

sourcetype: Spectroscopic type.

nvote: Total number of votes.

p\_el, p\_cw, p\_acw, p\_edge, p\_dk, p\_mg: Percentage of vote for each
class.

    \subsubsection{Data Imputation: }\label{data-imputation}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Only subclass feature has}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}\PY{o}{/}\PY{l+m+mi}{10000}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{} e}\PY{l+s+s1}{mpty cells}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Only subclass feature has 75.47 \% empty cells

    \end{Verbatim}

    and class distribution of this feature is like;

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{NaN}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Uncertain}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}79}]:} \PY{n}{a4\PYZus{}dims} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}
         \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{n}{a4\PYZus{}dims}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{countplot}\PY{p}{(}\PY{n}{y}\PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{subClass}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n}{df}\PY{p}{,}\PY{n}{palette}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Paired}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_34_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Due to the heavy dominance of missing vallues, it is pretty clear that
'subClass' feature can not be used as a target untill and unless more
data has been recorded.

again, p\_el, p\_cw, p\_acw, p\_edge, p\_dk, p\_mg does not have a
significance if left separated. Instead of keeping them separated, a new
combined feature 'morphClass' is created with a thresholf of 50\%.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{n}{prob\PYZus{}col} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZus{}el}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZus{}cw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZus{}acw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZus{}edge}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZus{}dk}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZus{}mg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}fig, axes = plt.subplots(figsize=(4, 4))}
         \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{prob\PYZus{}col}\PY{p}{]}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}df[prob\PYZus{}col]}
         \PY{k}{def} \PY{n+nf}{tune\PYZus{}wrt\PYZus{}class}\PY{p}{(}\PY{n}{col}\PY{p}{,}\PY{n}{data}\PY{p}{)}\PY{p}{:}
             \PY{n}{c} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{col}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{col}\PY{p}{:}
                 \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{i} \PY{p}{]} \PY{o}{=} \PY{n}{c}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3}
                 \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{i} \PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{c}\PY{o}{\PYZhy{}}\PY{o}{=}\PY{l+m+mi}{1}        
         \PY{n}{tune\PYZus{}wrt\PYZus{}class}\PY{p}{(}\PY{n}{prob\PYZus{}col}\PY{p}{,}\PY{n}{df}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}print(df[prob\PYZus{}col])}
         
         \PY{n}{temp} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{prob\PYZus{}col}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{temp}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{skipna} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
         
         
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+m+mi}{224}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{el\PYZus{}dk}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{217}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{el\PYZus{}mg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{uncertain}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dk}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{27}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{edge}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{64}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{acw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{125}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{216}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{el}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)} 
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_36_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{Data Visualizaion:}\label{data-visualizaion}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{c+c1}{\PYZsh{}df[\PYZsq{}subClass\PYZsq{}].unique()}
         \PY{n}{col} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{fig}\PY{p}{,} \PY{n}{axes} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{nrows}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{ncols}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{j} \PY{o}{=} \PY{l+m+mi}{2}
         \PY{n}{colval} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{:}
             \PY{n}{ax} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{==}\PY{n}{colval}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{p}{]}\PY{o}{.}\PY{n}{redshift}\PY{p}{,} \PY{n}{bins} \PY{o}{=} \PY{l+m+mi}{30}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{axes}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{colval}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}
             \PY{n}{j}\PY{o}{\PYZhy{}}\PY{o}{=}\PY{l+m+mi}{1}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{axes} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{nrows}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{ncols}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{countplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}sns.scatterplot(df[\PYZsq{}morphClass\PYZsq{}],df[\PYZsq{}redshift\PYZsq{}])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_39_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}83}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{axes} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{nrows}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{ncols}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{redshift}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_40_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}126}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{18}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
          \PY{n}{n} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{redshift}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{plate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mjd}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{morphClass}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,}\PY{n}{hue}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{morphClass}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{palette}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Paired}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<Figure size 1296x144 with 0 Axes>
    \end{verbatim}

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_41_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}123}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{18}\PY{p}{,}\PY{l+m+mi}{18}\PY{p}{)}\PY{p}{)}
          \PY{n}{n1} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{u}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{g}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{r}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{i}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{z}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{morphClass}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{p}{]}\PY{p}{]}\PY{p}{,}\PY{n}{hue}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{morphClass}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{palette}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Paired}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{c+c1}{\PYZsh{},hue\PYZus{}order=[\PYZdq{}QSO\PYZdq{},\PYZdq{}GALAXY\PYZdq{},\PYZdq{}STAR\PYZdq{}])}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<Figure size 1296x1296 with 0 Axes>
    \end{verbatim}

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_42_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{Data Correlation}\label{data-correlation}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{fig} \PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x1cebf1aec18>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_44_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{n}{f}\PY{p}{,}\PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}k = sns.scatterplot(\PYZdq{}dec\PYZdq{},\PYZdq{}ra\PYZdq{},hue=\PYZdq{}class\PYZdq{},data=Data,cmap=\PYZdq{}magma\PYZdq{})}
         \PY{n}{Stars} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{class}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{STAR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{Galaxy} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{class}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GALAXY}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{Qso} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{class}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{QSO}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{k} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{kdeplot}\PY{p}{(}\PY{n}{Qso}\PY{o}{.}\PY{n}{dec}\PY{p}{,}\PY{n}{Qso}\PY{o}{.}\PY{n}{ra}\PY{p}{,}\PY{n}{shade}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{shade\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magma}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
         \PY{n}{k} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{kdeplot}\PY{p}{(}\PY{n}{Galaxy}\PY{o}{.}\PY{n}{dec}\PY{p}{,}\PY{n}{Galaxy}\PY{o}{.}\PY{n}{ra}\PY{p}{,}\PY{n}{shade}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{shade\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rainbow}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         \PY{n}{k} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{kdeplot}\PY{p}{(}\PY{n}{Stars}\PY{o}{.}\PY{n}{dec}\PY{p}{,}\PY{n}{Stars}\PY{o}{.}\PY{n}{ra}\PY{p}{,}\PY{n}{shade}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{shade\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{plasma\PYZus{}r}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dec}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dec}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dec}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ra}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ra}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ra}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Quasar}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Galaxy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Stars}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}k = sns.kdeplot(Data[\PYZdq{}dec\PYZdq{}],Data[\PYZdq{}ra\PYZdq{}],shade=True,shade\PYZus{}lowest=False,cmap=\PYZdq{}magma\PYZdq{},ax=ax)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_45_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}127}]:} \PY{n}{f}\PY{p}{,}\PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}k = sns.scatterplot(\PYZdq{}dec\PYZdq{},\PYZdq{}ra\PYZdq{},hue=\PYZdq{}class\PYZdq{},data=Data,cmap=\PYZdq{}magma\PYZdq{})}
          \PY{n}{undefined} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{morphClass}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{uncertain}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
          \PY{n}{el} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{morphClass}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{el}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
          \PY{n}{edge} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{morphClass}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{edge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
          
          
          \PY{n}{k} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{kdeplot}\PY{p}{(}\PY{n}{edge}\PY{o}{.}\PY{n}{dec}\PY{p}{,}\PY{n}{edge}\PY{o}{.}\PY{n}{ra}\PY{p}{,}\PY{n}{shade}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{shade\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magma}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
          \PY{n}{k} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{kdeplot}\PY{p}{(}\PY{n}{el}\PY{o}{.}\PY{n}{dec}\PY{p}{,}\PY{n}{el}\PY{o}{.}\PY{n}{ra}\PY{p}{,}\PY{n}{shade}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{shade\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rainbow}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
          \PY{n}{k} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{kdeplot}\PY{p}{(}\PY{n}{undefined}\PY{o}{.}\PY{n}{dec}\PY{p}{,}\PY{n}{undefined}\PY{o}{.}\PY{n}{ra}\PY{p}{,}\PY{n}{shade}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{shade\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{plasma\PYZus{}r}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dec}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
          \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dec}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
          \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dec}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
          \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ra}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
          \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ra}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
          \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ra}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
          \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Galaxy with Light Edge}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
          \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Elliptical Galaxy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
          \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Irregular Galaxy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}k = sns.kdeplot(Data[\PYZdq{}dec\PYZdq{}],Data[\PYZdq{}ra\PYZdq{}],shade=True,shade\PYZus{}lowest=False,cmap=\PYZdq{}magma\PYZdq{},ax=ax)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_46_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}88}]:} \PY{n}{f}\PY{p}{,}\PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}k = sns.scatterplot(\PYZdq{}dec\PYZdq{},\PYZdq{}ra\PYZdq{},hue=\PYZdq{}class\PYZdq{},data=Data,cmap=\PYZdq{}magma\PYZdq{})}
         \PY{n}{dk} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{morphClass}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dk}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{acw} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{morphClass}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{acw}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{cw} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{morphClass}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cw}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         
         
         \PY{n}{k} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{kdeplot}\PY{p}{(}\PY{n}{dk}\PY{o}{.}\PY{n}{dec}\PY{p}{,}\PY{n}{dk}\PY{o}{.}\PY{n}{ra}\PY{p}{,}\PY{n}{shade}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{shade\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magma}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
         \PY{n}{k} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{kdeplot}\PY{p}{(}\PY{n}{acw}\PY{o}{.}\PY{n}{dec}\PY{p}{,}\PY{n}{acw}\PY{o}{.}\PY{n}{ra}\PY{p}{,}\PY{n}{shade}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{shade\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rainbow}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         \PY{n}{k} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{kdeplot}\PY{p}{(}\PY{n}{cw}\PY{o}{.}\PY{n}{dec}\PY{p}{,}\PY{n}{cw}\PY{o}{.}\PY{n}{ra}\PY{p}{,}\PY{n}{shade}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{shade\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{plasma\PYZus{}r}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dec}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dec}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dec}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ra}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ra}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ra}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Ring Galaxy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Anti\PYZhy{}Clockwise Spiral Galaxy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Clockwise Spiral Galaxy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}k = sns.kdeplot(Data[\PYZdq{}dec\PYZdq{}],Data[\PYZdq{}ra\PYZdq{}],shade=True,shade\PYZus{}lowest=False,cmap=\PYZdq{}magma\PYZdq{},ax=ax)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_47_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}89}]:} \PY{n}{f}\PY{p}{,}\PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}k = sns.scatterplot(\PYZdq{}dec\PYZdq{},\PYZdq{}ra\PYZdq{},hue=\PYZdq{}class\PYZdq{},data=Data,cmap=\PYZdq{}magma\PYZdq{})}
         \PY{n}{mg} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{morphClass}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mg}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         
         
         \PY{n}{k} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{kdeplot}\PY{p}{(}\PY{n}{mg}\PY{o}{.}\PY{n}{dec}\PY{p}{,}\PY{n}{mg}\PY{o}{.}\PY{n}{ra}\PY{p}{,}\PY{n}{shade}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{shade\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{magma}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dec}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ra}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Merger Galaxy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_48_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Feature Elimination: }\label{feature-elimination}

Dataset-2 contains many unnecessary features which are of no use to us.
Those unnecessary features are removed. Elliptical Merger Galaxy and
Elliptical Disk galaxy is a rare among the rarest phenomena. Removign
this record to balance the dataset some more.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}92}]:} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{objid}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rerun}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fiberid}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{specobjid}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{nvote}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{prob\PYZus{}col}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{el\PYZus{}dk}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{el\PYZus{}mg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \subsubsection{Feature Extraction and Data
Splitting:}\label{feature-extraction-and-data-splitting}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}143}]:} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}U}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR50\PYZus{}u}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR90\PYZus{}u}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
          \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}G}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR50\PYZus{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR90\PYZus{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}R}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR50\PYZus{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR90\PYZus{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
          \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR50\PYZus{}i}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR90\PYZus{}i}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
          \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}Z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR50\PYZus{}z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR90\PYZus{}z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
          
          
          \PY{n}{target\PYZus{}col} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}col} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{u}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{i}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mCr4\PYZus{}u}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mCr4\PYZus{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mCr4\PYZus{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mCr4\PYZus{}i}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mCr4\PYZus{}z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}U}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}G}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}R}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}Z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{sdss} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{o}{+}\PY{n}{target\PYZus{}col}\PY{p}{]}
          
          \PY{c+c1}{\PYZsh{}sdss\PYZus{}feature = df[feature\PYZus{}col]}
          \PY{c+c1}{\PYZsh{}sdss\PYZus{}target\PYZus{}class = df[\PYZsq{}class\PYZsq{}]}
          \PY{c+c1}{\PYZsh{}sdss\PYZus{}target\PYZus{}morphClass = df[\PYZsq{}morphClass\PYZsq{}]}
          
          \PY{c+c1}{\PYZsh{}for i in sdss\PYZus{}target\PYZus{}col:}
          \PY{c+c1}{\PYZsh{}    sdss[i].fillna(\PYZdq{}Uncertain\PYZdq{}, inplace = True)}
          
          \PY{n}{fraction\PYZus{}training} \PY{o}{=} \PY{l+m+mf}{0.7}
          \PY{n}{msk} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{rand}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{sdss}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{n}{fraction\PYZus{}training}
          \PY{n}{sdss\PYZus{}train} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{n}{msk}\PY{p}{]}
          \PY{n}{sdss\PYZus{}test} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{msk}\PY{p}{]}
          
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number data galaxies:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sdss}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train fraction:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fraction\PYZus{}training}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of galaxies in training set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sdss\PYZus{}train}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of galaxies in testing set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sdss\PYZus{}test}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}feature and target separation}
          \PY{n}{sdss\PYZus{}feature} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{p}{]}
          \PY{n}{sdss\PYZus{}target\PYZus{}class} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{sdss\PYZus{}target\PYZus{}morphClass} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{sdss\PYZus{}train\PYZus{}feature} \PY{o}{=} \PY{n}{sdss\PYZus{}train}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{p}{]}
          \PY{n}{sdss\PYZus{}train\PYZus{}target\PYZus{}class} \PY{o}{=} \PY{n}{sdss\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{sdss\PYZus{}train\PYZus{}target\PYZus{}morphClass} \PY{o}{=} \PY{n}{sdss\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{sdss\PYZus{}test\PYZus{}feature} \PY{o}{=} \PY{n}{sdss\PYZus{}test}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{p}{]}
          \PY{n}{sdss\PYZus{}test\PYZus{}target\PYZus{}class} \PY{o}{=} \PY{n}{sdss\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{sdss\PYZus{}test\PYZus{}target\PYZus{}morphClass} \PY{o}{=} \PY{n}{sdss\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          
          \PY{n}{sdss\PYZus{}classtarget} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{p}{]}
          \PY{n}{sdss\PYZus{}classtarget}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{sdss\PYZus{}morphtarget} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{p}{]}
          \PY{n}{sdss\PYZus{}morphtarget}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Number data galaxies: 9996
Train fraction: 0.7
Number of galaxies in training set: 7064
Number of galaxies in testing set: 2932

    \end{Verbatim}

    \subsubsection{Spectroscopic Classification using Decision Tree
Classifier:}\label{spectroscopic-classification-using-decision-tree-classifier}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}151}]:} \PY{n}{dtc} \PY{o}{=} \PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{p}{)}
          \PY{n}{dtc}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{sdss\PYZus{}train\PYZus{}feature}\PY{p}{,} \PY{n}{sdss\PYZus{}train\PYZus{}target\PYZus{}class}\PY{p}{)}
          \PY{n}{sdss\PYZus{}predictions} \PY{o}{=} \PY{n}{dtc}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{sdss\PYZus{}test\PYZus{}feature}\PY{p}{)}
          
          \PY{n}{sdss\PYZus{}predicted} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}predict}\PY{p}{(}\PY{n}{dtc}\PY{p}{,} \PY{n}{sdss\PYZus{}feature}\PY{p}{,} \PY{n}{sdss\PYZus{}target\PYZus{}class}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} calculate the model score using your function}
          \PY{n}{sdss\PYZus{}model\PYZus{}score} \PY{o}{=} \PY{n}{calculate\PYZus{}accuracy}\PY{p}{(}\PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{sdss\PYZus{}target\PYZus{}class}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Our accuracy score:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{sdss\PYZus{}model\PYZus{}score}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} calculate the models confusion matrix using sklearns confusion\PYZus{}matrix function}
          \PY{n}{sdss\PYZus{}class\PYZus{}labels} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{sdss\PYZus{}target\PYZus{}class}\PY{p}{)}\PY{p}{)}
          \PY{n}{sdss\PYZus{}model\PYZus{}cm\PYZus{}dtc} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}true}\PY{o}{=}\PY{n}{sdss\PYZus{}target\PYZus{}class}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{o}{=}\PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}labels}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}classification report}
          \PY{c+c1}{\PYZsh{}from sklearn.metrics import classification\PYZus{}report}
          \PY{n}{class\PYZus{}names} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{classification report of Decision Tree Classifier:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{sdss\PYZus{}target\PYZus{}class}\PY{p}{,} \PY{n}{sdss\PYZus{}predicted}\PY{p}{,}\PY{n}{target\PYZus{}names}\PY{o}{=}\PY{n}{class\PYZus{}names}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Plot the confusion matrix using the provided functions.}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plot\PYZus{}confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{sdss\PYZus{}model\PYZus{}cm\PYZus{}dtc}\PY{p}{,} \PY{n}{classes}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}labels}\PY{p}{,} \PY{n}{normalize}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Our accuracy score: 0.9401760704281713
classification report of Decision Tree Classifier:

             precision    recall  f1-score   support

     GALAXY       0.97      0.97      0.97      9398
        QSO       0.16      0.19      0.18       153
       STAR       0.61      0.65      0.63       445

avg / total       0.94      0.94      0.94      9996

Confusion matrix, without normalization
[[9079  178  141]
 [ 149  290    6]
 [ 120    4   29]]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_54_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Morphological Classification using Decision Tree
Classifier:}\label{morphological-classification-using-decision-tree-classifier}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}153}]:} \PY{n}{dtc} \PY{o}{=} \PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{p}{)}
          \PY{n}{dtc}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{sdss\PYZus{}train\PYZus{}feature}\PY{p}{,} \PY{n}{sdss\PYZus{}train\PYZus{}target\PYZus{}morphClass}\PY{p}{)}
          \PY{n}{sdss\PYZus{}predictions} \PY{o}{=} \PY{n}{dtc}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{sdss\PYZus{}test\PYZus{}feature}\PY{p}{)}
          
          \PY{n}{sdss\PYZus{}predicted} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}predict}\PY{p}{(}\PY{n}{dtc}\PY{p}{,} \PY{n}{sdss\PYZus{}feature}\PY{p}{,} \PY{n}{sdss\PYZus{}target\PYZus{}morphClass}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} calculate the model score using your function}
          \PY{n}{sdss\PYZus{}model\PYZus{}score} \PY{o}{=} \PY{n}{calculate\PYZus{}accuracy}\PY{p}{(}\PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{sdss\PYZus{}target\PYZus{}morphClass}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Our accuracy score:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{sdss\PYZus{}model\PYZus{}score}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} calculate the models confusion matrix using sklearns confusion\PYZus{}matrix function}
          \PY{n}{sdss\PYZus{}class\PYZus{}labels} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{sdss\PYZus{}target\PYZus{}morphClass}\PY{p}{)}\PY{p}{)}
          \PY{n}{sdss\PYZus{}model\PYZus{}cm\PYZus{}dtc} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}true}\PY{o}{=}\PY{n}{sdss\PYZus{}target\PYZus{}morphClass}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{o}{=}\PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}labels}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}classification report}
          \PY{c+c1}{\PYZsh{}from sklearn.metrics import classification\PYZus{}report}
          \PY{n}{class\PYZus{}names} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{classification report of Decision Tree Classifier:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{sdss\PYZus{}target\PYZus{}morphClass}\PY{p}{,} \PY{n}{sdss\PYZus{}predicted}\PY{p}{,}\PY{n}{target\PYZus{}names}\PY{o}{=}\PY{n}{class\PYZus{}names}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Plot the confusion matrix using the provided functions.}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plot\PYZus{}confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{sdss\PYZus{}model\PYZus{}cm\PYZus{}dtc}\PY{p}{,} \PY{n}{classes}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}labels}\PY{p}{,} \PY{n}{normalize}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Our accuracy score: 0.6854741896758704
classification report of Decision Tree Classifier:

             precision    recall  f1-score   support

  uncertain       0.18      0.21      0.19       107
         el       0.21      0.19      0.20       108
       edge       0.32      0.34      0.33       489
         dk       0.21      0.22      0.22       275
        acw       0.84      0.83      0.83      7298
         cw       0.09      0.12      0.11       108
         mg       0.32      0.33      0.33      1611

avg / total       0.69      0.69      0.69      9996

Confusion matrix, without normalization
[[  21   16   19   12    7    3   30]
 [  16   22   22    9   12    4   22]
 [  16   20 6038  169  112   87  856]
 [   8   14  151  166   19    4  127]
 [   9    9   87   37   61   10   62]
 [   3    3   67    4    3   13   15]
 [  28   40  798  124   72   18  531]]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_56_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Spectroscopic Classification using Random Forest
Classifier}\label{spectroscopic-classification-using-random-forest-classifier}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}181}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{cross\PYZus{}val\PYZus{}predict}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}
          
          
          \PY{c+c1}{\PYZsh{} complete this function to get predictions from a random forest classifier}
          \PY{k}{def} \PY{n+nf}{rf\PYZus{}predict\PYZus{}actual}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{n\PYZus{}estimators}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} generate the features and targets}
              \PY{n}{features} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{p}{]}
              \PY{n}{targets} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
            \PY{c+c1}{\PYZsh{} instantiate a random forest classifier}
              \PY{n}{rfc} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{n\PYZus{}estimators}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} get predictions using 10\PYZhy{}fold cross validation with cross\PYZus{}val\PYZus{}predict}
              \PY{n}{predicted} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}predict}\PY{p}{(}\PY{n}{rfc}\PY{p}{,} \PY{n}{features}\PY{p}{,} \PY{n}{targets}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} return the predictions and their actual classes}
              \PY{k}{return} \PY{n}{predicted}\PY{p}{,} \PY{n}{targets}
          
          
          \PY{c+c1}{\PYZsh{} get the predicted and actual classes}
          \PY{n}{sdss\PYZus{}number\PYZus{}estimators} \PY{o}{=} \PY{l+m+mi}{50}              \PY{c+c1}{\PYZsh{} Number of trees}
          \PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{sdss\PYZus{}actual} \PY{o}{=} \PY{n}{rf\PYZus{}predict\PYZus{}actual}\PY{p}{(}\PY{n}{sdss\PYZus{}classtarget}\PY{p}{,} \PY{n}{sdss\PYZus{}number\PYZus{}estimators}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} calculate the model score using your function}
          \PY{n}{sdss\PYZus{}accuracy} \PY{o}{=} \PY{n}{calculate\PYZus{}accuracy}\PY{p}{(}\PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{sdss\PYZus{}actual}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy score:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{sdss\PYZus{}accuracy}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} calculate the models confusion matrix using sklearns confusion\PYZus{}matrix function}
          \PY{n}{sdss\PYZus{}class\PYZus{}labels} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{sdss\PYZus{}actual}\PY{p}{)}\PY{p}{)}
          \PY{n}{sdss\PYZus{}model\PYZus{}cm\PYZus{}rfc} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}true}\PY{o}{=}\PY{n}{sdss\PYZus{}actual}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{o}{=}\PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}labels}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} classification report of Random Forest Classifier}
          \PY{n}{sdss\PYZus{}class\PYZus{}names} \PY{o}{=} \PY{n}{sdss\PYZus{}classtarget}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{classification report of Decision Tree Classifier:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{sdss\PYZus{}target\PYZus{}class}\PY{p}{,} \PY{n}{sdss\PYZus{}predicted}\PY{p}{,}\PY{n}{target\PYZus{}names}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}names}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} plot the confusion matrix using the provided functions.}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plot\PYZus{}confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{sdss\PYZus{}model\PYZus{}cm\PYZus{}rfc}\PY{p}{,} \PY{n}{classes}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}labels}\PY{p}{,} \PY{n}{normalize}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy score: 0.9671868747499
classification report of Decision Tree Classifier:

             precision    recall  f1-score   support

     GALAXY       0.97      1.00      0.98      9398
        QSO       0.55      0.07      0.13       153
       STAR       0.93      0.65      0.77       445

avg / total       0.96      0.97      0.96      9996

Confusion matrix, without normalization
[[9366   23    9]
 [ 154  291    0]
 [ 142    0   11]]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_58_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Morphological Classification using Random Forest
Classifier:}\label{morphological-classification-using-random-forest-classifier}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}183}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{cross\PYZus{}val\PYZus{}predict}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}
          
          
          \PY{c+c1}{\PYZsh{} complete this function to get predictions from a random forest classifier}
          \PY{k}{def} \PY{n+nf}{rf\PYZus{}predict\PYZus{}actual}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{n\PYZus{}estimators}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} generate the features and targets}
              \PY{n}{features} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{p}{]}
              \PY{n}{targets} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
            \PY{c+c1}{\PYZsh{} instantiate a random forest classifier}
              \PY{n}{rfc} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{n\PYZus{}estimators}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} get predictions using 10\PYZhy{}fold cross validation with cross\PYZus{}val\PYZus{}predict}
              \PY{n}{predicted} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}predict}\PY{p}{(}\PY{n}{rfc}\PY{p}{,} \PY{n}{features}\PY{p}{,} \PY{n}{targets}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} return the predictions and their actual classes}
              \PY{k}{return} \PY{n}{predicted}\PY{p}{,} \PY{n}{targets}
          
          
          \PY{c+c1}{\PYZsh{} get the predicted and actual classes}
          \PY{n}{sdss\PYZus{}number\PYZus{}estimators} \PY{o}{=} \PY{l+m+mi}{50}              \PY{c+c1}{\PYZsh{} Number of trees}
          \PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{sdss\PYZus{}actual} \PY{o}{=} \PY{n}{rf\PYZus{}predict\PYZus{}actual}\PY{p}{(}\PY{n}{sdss\PYZus{}morphtarget}\PY{p}{,} \PY{n}{sdss\PYZus{}number\PYZus{}estimators}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} calculate the model score using your function}
          \PY{n}{sdss\PYZus{}accuracy} \PY{o}{=} \PY{n}{calculate\PYZus{}accuracy}\PY{p}{(}\PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{sdss\PYZus{}actual}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy score:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{sdss\PYZus{}accuracy}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} calculate the models confusion matrix using sklearns confusion\PYZus{}matrix function}
          \PY{n}{sdss\PYZus{}class\PYZus{}labels} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{sdss\PYZus{}actual}\PY{p}{)}\PY{p}{)}
          \PY{n}{sdss\PYZus{}model\PYZus{}cm\PYZus{}rfc} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}true}\PY{o}{=}\PY{n}{sdss\PYZus{}actual}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{o}{=}\PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}labels}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} classification report of Random Forest Classifier}
          \PY{n}{sdss\PYZus{}class\PYZus{}names} \PY{o}{=} \PY{n}{sdss\PYZus{}morphtarget}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{classification report of Decision Tree Classifier:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{sdss\PYZus{}target\PYZus{}morphClass}\PY{p}{,} \PY{n}{sdss\PYZus{}predicted}\PY{p}{,}\PY{n}{target\PYZus{}names}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}names}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} plot the confusion matrix using the provided functions.}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plot\PYZus{}confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{sdss\PYZus{}model\PYZus{}cm\PYZus{}rfc}\PY{p}{,} \PY{n}{classes}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}labels}\PY{p}{,} \PY{n}{normalize}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy score: 0.7762104841936774
classification report of Decision Tree Classifier:

             precision    recall  f1-score   support

  uncertain       0.33      0.18      0.23       107
         el       0.42      0.24      0.31       108
       edge       0.52      0.36      0.42       489
         dk       0.46      0.21      0.29       275
        acw       0.83      0.95      0.89      7298
         cw       0.91      0.09      0.17       108
         mg       0.50      0.34      0.40      1611

avg / total       0.74      0.78      0.75      9996

Confusion matrix, without normalization
[[  26    6   24   12    8    0   32]
 [  13   19   20    7    6    0   42]
 [   4    6 6928   53   14    0  293]
 [   7    8  186  174    7    1  106]
 [   0    4  132   21   58    0   60]
 [   1    0   82    2    1   10   12]
 [  11   15  946   64   31    0  544]]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_60_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Dataset 3:}\label{dataset-3}

Now the final dataset will be used to check whether the accuracies are
improving or not.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}193}]:} \PY{n}{df}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D:///ThirdFinalProject///Data\PYZus{}Mining/thirddata.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Dataset 2 contains }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ entries and }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ features}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Dataset 2 contains 100000 entries and 46 features
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 100000 entries, 0 to 99999
Data columns (total 46 columns):
ra            100000 non-null float64
dec           100000 non-null float64
u             100000 non-null float64
g             100000 non-null float64
r             100000 non-null float64
i             100000 non-null float64
z             100000 non-null float64
run           100000 non-null int64
rerun         100000 non-null int64
camcol        100000 non-null int64
field         100000 non-null int64
mCr4\_u        100000 non-null float64
mCr4\_g        100000 non-null float64
mCr4\_r        100000 non-null float64
mCr4\_i        100000 non-null float64
mCr4\_z        100000 non-null float64
mCr4PSF\_u     100000 non-null float64
mCr4PSF\_g     100000 non-null float64
mCr4PSF\_r     100000 non-null float64
mCr4PSF\_i     100000 non-null float64
mCr4PSF\_z     100000 non-null float64
petroR50\_u    100000 non-null float64
petroR50\_g    100000 non-null float64
petroR50\_r    100000 non-null float64
petroR50\_i    100000 non-null float64
petroR50\_z    100000 non-null float64
petroR90\_u    100000 non-null float64
petroR90\_g    100000 non-null float64
petroR90\_r    100000 non-null float64
petroR90\_i    100000 non-null float64
petroR90\_z    100000 non-null float64
type          100000 non-null int64
class         100000 non-null object
subClass      22966 non-null object
redshift      100000 non-null float64
plate         100000 non-null int64
mjd           100000 non-null int64
fiberid       100000 non-null int64
sourceType    100000 non-null object
nvote         100000 non-null int64
p\_el          100000 non-null float64
p\_cw          100000 non-null float64
p\_acw         100000 non-null float64
p\_edge        100000 non-null float64
p\_dk          100000 non-null float64
p\_mg          100000 non-null float64
dtypes: float64(34), int64(9), object(3)
memory usage: 35.1+ MB
None

    \end{Verbatim}

    \subsubsection{Creating morphClass
feature:}\label{creating-morphclass-feature}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}195}]:} \PY{n}{prob\PYZus{}col} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZus{}el}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZus{}cw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZus{}acw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZus{}edge}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZus{}dk}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZus{}mg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{c+c1}{\PYZsh{}fig, axes = plt.subplots(figsize=(4, 4))}
          \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{prob\PYZus{}col}\PY{p}{]}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}df[prob\PYZus{}col]}
          \PY{k}{def} \PY{n+nf}{tune\PYZus{}wrt\PYZus{}class}\PY{p}{(}\PY{n}{col}\PY{p}{,}\PY{n}{data}\PY{p}{)}\PY{p}{:}
              \PY{n}{c} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{col}\PY{p}{)}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{col}\PY{p}{:}
                  \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{i} \PY{p}{]} \PY{o}{=} \PY{n}{c}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3}
                  \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{i} \PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
                  \PY{n}{c}\PY{o}{\PYZhy{}}\PY{o}{=}\PY{l+m+mi}{1}        
          \PY{n}{tune\PYZus{}wrt\PYZus{}class}\PY{p}{(}\PY{n}{prob\PYZus{}col}\PY{p}{,}\PY{n}{df}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}print(df[prob\PYZus{}col])}
          
          \PY{n}{temp} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{prob\PYZus{}col}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{temp}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{skipna} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
          
          
          \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+m+mi}{224}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{el\PYZus{}dk}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{217}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{el\PYZus{}mg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{uncertain}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dk}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{27}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{edge}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{64}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{acw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{125}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{216}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{el}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)} 
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_64_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Some Visualizations:}\label{some-visualizations}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}196}]:} \PY{c+c1}{\PYZsh{}df[\PYZsq{}subClass\PYZsq{}].unique()}
          \PY{n}{col} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}
          \PY{n}{fig}\PY{p}{,} \PY{n}{axes} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{nrows}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{ncols}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{j} \PY{o}{=} \PY{l+m+mi}{2}
          \PY{n}{colval} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{:}
              \PY{n}{ax} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{==}\PY{n}{colval}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{p}{]}\PY{o}{.}\PY{n}{redshift}\PY{p}{,} \PY{n}{bins} \PY{o}{=} \PY{l+m+mi}{30}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{axes}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{colval}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}
              \PY{n}{j}\PY{o}{\PYZhy{}}\PY{o}{=}\PY{l+m+mi}{1}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_66_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}197}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{axes} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{nrows}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{ncols}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
          \PY{n}{sns}\PY{o}{.}\PY{n}{countplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}sns.scatterplot(df[\PYZsq{}morphClass\PYZsq{}],df[\PYZsq{}redshift\PYZsq{}])}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_67_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}198}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{18}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
          \PY{n}{n} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{redshift}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{plate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mjd}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{morphClass}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,}\PY{n}{hue}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{morphClass}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{palette}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Paired}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<Figure size 1296x144 with 0 Axes>
    \end{verbatim}

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Feature Elimination:}\label{feature-elimination}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}201}]:} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rerun}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fiberid}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{nvote}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{prob\PYZus{}col}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{el\PYZus{}dk}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{el\PYZus{}mg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \subsubsection{Feature Extraction and Data
Splitting:}\label{feature-extraction-and-data-splitting}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}202}]:} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}U}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR50\PYZus{}u}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR90\PYZus{}u}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
          \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}G}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR50\PYZus{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR90\PYZus{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}R}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR50\PYZus{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR90\PYZus{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
          \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR50\PYZus{}i}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR90\PYZus{}i}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
          \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}Z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR50\PYZus{}z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petroR90\PYZus{}z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
          
          
          \PY{n}{target\PYZus{}col} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{feature\PYZus{}col} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{u}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{i}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mCr4\PYZus{}u}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mCr4\PYZus{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mCr4\PYZus{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mCr4\PYZus{}i}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mCr4\PYZus{}z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}U}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}G}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}R}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}I}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Con\PYZus{}Z}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{sdss} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{o}{+}\PY{n}{target\PYZus{}col}\PY{p}{]}
          
          \PY{c+c1}{\PYZsh{}sdss\PYZus{}feature = df[feature\PYZus{}col]}
          \PY{c+c1}{\PYZsh{}sdss\PYZus{}target\PYZus{}class = df[\PYZsq{}class\PYZsq{}]}
          \PY{c+c1}{\PYZsh{}sdss\PYZus{}target\PYZus{}morphClass = df[\PYZsq{}morphClass\PYZsq{}]}
          
          \PY{c+c1}{\PYZsh{}for i in sdss\PYZus{}target\PYZus{}col:}
          \PY{c+c1}{\PYZsh{}    sdss[i].fillna(\PYZdq{}Uncertain\PYZdq{}, inplace = True)}
          
          \PY{n}{fraction\PYZus{}training} \PY{o}{=} \PY{l+m+mf}{0.7}
          \PY{n}{msk} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{rand}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{sdss}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{n}{fraction\PYZus{}training}
          \PY{n}{sdss\PYZus{}train} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{n}{msk}\PY{p}{]}
          \PY{n}{sdss\PYZus{}test} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{msk}\PY{p}{]}
          
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number data galaxies:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sdss}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train fraction:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fraction\PYZus{}training}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of galaxies in training set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sdss\PYZus{}train}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of galaxies in testing set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sdss\PYZus{}test}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}feature and target separation}
          \PY{n}{sdss\PYZus{}feature} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{p}{]}
          \PY{n}{sdss\PYZus{}target\PYZus{}class} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{sdss\PYZus{}target\PYZus{}morphClass} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{sdss\PYZus{}train\PYZus{}feature} \PY{o}{=} \PY{n}{sdss\PYZus{}train}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{p}{]}
          \PY{n}{sdss\PYZus{}train\PYZus{}target\PYZus{}class} \PY{o}{=} \PY{n}{sdss\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{sdss\PYZus{}train\PYZus{}target\PYZus{}morphClass} \PY{o}{=} \PY{n}{sdss\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{sdss\PYZus{}test\PYZus{}feature} \PY{o}{=} \PY{n}{sdss\PYZus{}test}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{p}{]}
          \PY{n}{sdss\PYZus{}test\PYZus{}target\PYZus{}class} \PY{o}{=} \PY{n}{sdss\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{sdss\PYZus{}test\PYZus{}target\PYZus{}morphClass} \PY{o}{=} \PY{n}{sdss\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          
          \PY{n}{sdss\PYZus{}classtarget} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{p}{]}
          \PY{n}{sdss\PYZus{}classtarget}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{sdss\PYZus{}morphtarget} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{p}{]}
          \PY{n}{sdss\PYZus{}morphtarget}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{morphClass}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Number data galaxies: 99957
Train fraction: 0.7
Number of galaxies in training set: 70067
Number of galaxies in testing set: 29890

    \end{Verbatim}

    \subsubsection{Spectroscopic Classification using Decision
Tree}\label{spectroscopic-classification-using-decision-tree}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}203}]:} \PY{n}{dtc} \PY{o}{=} \PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{p}{)}
          \PY{n}{dtc}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{sdss\PYZus{}train\PYZus{}feature}\PY{p}{,} \PY{n}{sdss\PYZus{}train\PYZus{}target\PYZus{}class}\PY{p}{)}
          \PY{n}{sdss\PYZus{}predictions} \PY{o}{=} \PY{n}{dtc}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{sdss\PYZus{}test\PYZus{}feature}\PY{p}{)}
          
          \PY{n}{sdss\PYZus{}predicted} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}predict}\PY{p}{(}\PY{n}{dtc}\PY{p}{,} \PY{n}{sdss\PYZus{}feature}\PY{p}{,} \PY{n}{sdss\PYZus{}target\PYZus{}class}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} calculate the model score using your function}
          \PY{n}{sdss\PYZus{}model\PYZus{}score} \PY{o}{=} \PY{n}{calculate\PYZus{}accuracy}\PY{p}{(}\PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{sdss\PYZus{}target\PYZus{}class}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Our accuracy score:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{sdss\PYZus{}model\PYZus{}score}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} calculate the models confusion matrix using sklearns confusion\PYZus{}matrix function}
          \PY{n}{sdss\PYZus{}class\PYZus{}labels} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{sdss\PYZus{}target\PYZus{}class}\PY{p}{)}\PY{p}{)}
          \PY{n}{sdss\PYZus{}model\PYZus{}cm\PYZus{}dtc} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}true}\PY{o}{=}\PY{n}{sdss\PYZus{}target\PYZus{}class}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{o}{=}\PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}labels}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}classification report}
          \PY{c+c1}{\PYZsh{}from sklearn.metrics import classification\PYZus{}report}
          \PY{n}{class\PYZus{}names} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{classification report of Decision Tree Classifier:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{sdss\PYZus{}target\PYZus{}class}\PY{p}{,} \PY{n}{sdss\PYZus{}predicted}\PY{p}{,}\PY{n}{target\PYZus{}names}\PY{o}{=}\PY{n}{class\PYZus{}names}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Plot the confusion matrix using the provided functions.}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plot\PYZus{}confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{sdss\PYZus{}model\PYZus{}cm\PYZus{}dtc}\PY{p}{,} \PY{n}{classes}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}labels}\PY{p}{,} \PY{n}{normalize}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Our accuracy score: 0.9453865162019669
classification report of Decision Tree Classifier:

             precision    recall  f1-score   support

     GALAXY       0.97      0.97      0.97     93545
        QSO       0.22      0.23      0.22      1558
       STAR       0.68      0.69      0.69      4854

avg / total       0.95      0.95      0.95     99957

Confusion matrix, without normalization
[[90770  1527  1248]
 [ 1427  3366    61]
 [ 1148    48   362]]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_74_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Morphologic Classification using Decision
Tree}\label{morphologic-classification-using-decision-tree}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}209}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{cross\PYZus{}val\PYZus{}predict}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}
          
          
          \PY{c+c1}{\PYZsh{} complete this function to get predictions from a random forest classifier}
          \PY{k}{def} \PY{n+nf}{rf\PYZus{}predict\PYZus{}actual}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{n\PYZus{}estimators}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} generate the features and targets}
              \PY{n}{features} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{n}{feature\PYZus{}col}\PY{p}{]}
              \PY{n}{targets} \PY{o}{=} \PY{n}{sdss}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
            \PY{c+c1}{\PYZsh{} instantiate a random forest classifier}
              \PY{n}{rfc} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{n\PYZus{}estimators}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} get predictions using 10\PYZhy{}fold cross validation with cross\PYZus{}val\PYZus{}predict}
              \PY{n}{predicted} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}predict}\PY{p}{(}\PY{n}{rfc}\PY{p}{,} \PY{n}{features}\PY{p}{,} \PY{n}{targets}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} return the predictions and their actual classes}
              \PY{k}{return} \PY{n}{predicted}\PY{p}{,} \PY{n}{targets}
          
          
          \PY{c+c1}{\PYZsh{} get the predicted and actual classes}
          \PY{n}{sdss\PYZus{}number\PYZus{}estimators} \PY{o}{=} \PY{l+m+mi}{50}              \PY{c+c1}{\PYZsh{} Number of trees}
          \PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{sdss\PYZus{}actual} \PY{o}{=} \PY{n}{rf\PYZus{}predict\PYZus{}actual}\PY{p}{(}\PY{n}{sdss\PYZus{}classtarget}\PY{p}{,} \PY{n}{sdss\PYZus{}number\PYZus{}estimators}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} calculate the model score using your function}
          \PY{n}{sdss\PYZus{}accuracy} \PY{o}{=} \PY{n}{calculate\PYZus{}accuracy}\PY{p}{(}\PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{sdss\PYZus{}actual}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy score:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{sdss\PYZus{}accuracy}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} calculate the models confusion matrix using sklearns confusion\PYZus{}matrix function}
          \PY{n}{sdss\PYZus{}class\PYZus{}labels} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{sdss\PYZus{}actual}\PY{p}{)}\PY{p}{)}
          \PY{n}{sdss\PYZus{}model\PYZus{}cm\PYZus{}rfc} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}true}\PY{o}{=}\PY{n}{sdss\PYZus{}actual}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{o}{=}\PY{n}{sdss\PYZus{}predicted}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}labels}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} classification report of Random Forest Classifier}
          \PY{n}{sdss\PYZus{}class\PYZus{}names} \PY{o}{=} \PY{n}{sdss\PYZus{}classtarget}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{classification report of Decision Tree Classifier:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{sdss\PYZus{}target\PYZus{}class}\PY{p}{,} \PY{n}{sdss\PYZus{}predicted}\PY{p}{,}\PY{n}{target\PYZus{}names}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}names}\PY{p}{)}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} plot the confusion matrix using the provided functions.}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plot\PYZus{}confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{sdss\PYZus{}model\PYZus{}cm\PYZus{}rfc}\PY{p}{,} \PY{n}{classes}\PY{o}{=}\PY{n}{sdss\PYZus{}class\PYZus{}labels}\PY{p}{,} \PY{n}{normalize}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy score: 0.9661854597476915
classification report of Decision Tree Classifier:

             precision    recall  f1-score   support

     GALAXY       0.97      1.00      0.98     93545
        QSO       0.49      0.08      0.13      1558
       STAR       0.92      0.68      0.78      4854

avg / total       0.96      0.97      0.96     99957

Confusion matrix, without normalization
[[93161   263   121]
 [ 1554  3296     4]
 [ 1430     8   120]]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_76_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Conclusion:}\label{conclusion}

\begin{itemize}
\tightlist
\item
  Accuracy improvement is possible using more data.
\item
  Accuracy improvement rate gets stuck due to data saturation.
\item
  Customized algorithm with better memory handling mechanism increases
  accuracy.
\item
  Data Saturation can be avoided by applying data folding methods or Big
  Data.
\end{itemize}

    \subsection{Scope:}\label{scope}

\begin{itemize}
\tightlist
\item
  Cloud computing can be used here.
\item
  Project can be used for better handing of the SDSS server.
\item
  Fetched and Optimized dataset can be used for educational purposes.
  (not suitable for commercial projects)
\item
  Project can be modified to use in other servers also.
\end{itemize}

    \subsection{Credit:}\label{credit}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  GalaxyZoo {[}https://blog.galaxyzoo.org/{]}
\item
  Sloan Digital Sky Survey {[}http://www.sdss3.org/{]}
\item
  Astronomy and Big Data: A Data Clustering Approach to Identifying
  Uncertain Galaxy Morphology
  {[}https://www.springer.com/in/book/9783319065984{]}
\item
  Encyclopaedia of Astronomy and Astrophysics.
  {[}http://www.astro.caltech.edu/\textasciitilde{}george/ay21/eaa/eaa-classif.pdf{]}
\end{enumerate}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
